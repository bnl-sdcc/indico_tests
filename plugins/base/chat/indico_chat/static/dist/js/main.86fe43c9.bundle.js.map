{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../plugins/base/chat/indico_chat/client/index.js","webpack:///../plugins/base/chat/indico_chat/client/main.scss?93c7"],"names":["global","$t","$T","domain","eventManageChat","$","on","e","preventDefault","toggler","closest","next","find","slideToggle","start","toggleClass","$this","msg","gettext","data","confirmPrompt","then","form","action","method","csrf","type","name","value","attr","append","appendTo","submit","ajax","url","dataType","complete","IndicoUI","Dialogs","Util","progress","success","handleAjaxError","result","AlertPopup","open","window","location","href","eventManageChatLogs","container","iframe","materialWidget","killProgress","logParams","ajaxForm","beforeSubmit","hide","error","doc","contentWindow","document","write","html","close","params","prop","show","materialName","val","trim","extend","material_name","blur","rangeWidget","daterange","allowPast","fieldNames","startDate","endDate","pickerOptions","yearRange"],"mappings":"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","file":"js/main.86fe43c9.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/plugins/chat/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","/* This file is part of Indico.\n * Copyright (C) 2002 - 2018 European Organization for Nuclear Research (CERN).\n *\n * Indico is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License as\n * published by the Free Software Foundation; either version 3 of the\n * License, or (at your option) any later version.\n *\n * Indico is distributed in the hope that it will be useful, but\n * WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Indico; if not, see <http://www.gnu.org/licenses/>.\n */\n\nimport './main.scss';\n\n(function(global) {\n    'use strict';\n    var $t = $T.domain('chat');\n\n    global.eventManageChat = function eventManageChat() {\n        $('.toggle-details').on('click', function(e) {\n            e.preventDefault();\n            var toggler = $(this);\n            toggler.closest('tr').next('tr').find('.details-container').slideToggle({\n                start: function() {\n                    toggler.toggleClass('icon-next icon-expand');\n                }\n            });\n        });\n\n        $('.js-chat-remove-room').on('click', function(e) {\n            e.preventDefault();\n            var $this = $(this);\n            var msg = $t.gettext('Do you really want to remove this chatroom from the event?');\n            if ($this.data('numEvents') == 1) {\n                msg += '<br>';\n                if ($this.data('customServer')) {\n                    msg += $t.gettext('Since it is on an external server, it will not be deleted on that server.');\n                } else {\n                    msg += $t.gettext('Since it is only used in this event, it will be deleted from the Jabber server, too!');\n                }\n            }\n            confirmPrompt(msg, $t.gettext('Delete this chatroom?')).then(function() {\n                var form = $('<form>', {\n                    action: $this.data('href'),\n                    method: 'post'\n                });\n                var csrf = $('<input>', {type: 'hidden', name: 'csrf_token', value: $('#csrf-token').attr('content')});\n                form.append(csrf).appendTo('body').submit();\n            });\n        });\n\n        $('.js-chat-refresh-room').on('click', function(e) {\n            e.preventDefault();\n            $.ajax({\n                url: $(this).data('href'),\n                type: 'POST',\n                dataType: 'json',\n                complete: IndicoUI.Dialogs.Util.progress(),\n                success: function(data) {\n                    if (handleAjaxError(data)) {\n                        return;\n                    }\n                    if (data.result == 'not-found') {\n                        new AlertPopup($t.gettext('Chatroom not found'), $t.gettext('The chatroom does not exist on the Jabber server anymore. We recommend you to delete it chatroom from Indico as well.')).open();\n                    } else if (data.result == 'changed') {\n                        new AlertPopup($t.gettext('Chatroom updated'), $t.gettext('The chatroom data has been updated.'), function() {\n                            window.location.href = window.location.href;\n                        }).open();\n                    }\n                }\n            });\n        });\n    };\n\n    global.eventManageChatLogs = function eventManageChatLogs() {\n        var container = $('#chat-log-display-container');\n        var iframe = $('#chat-log-display');\n        var materialWidget = $('#chat-log-material');\n        var killProgress;\n        var logParams;\n\n        $('#chat-log-form').ajaxForm({\n            dataType: 'json',\n            beforeSubmit: function() {\n                container.hide();\n                materialWidget.hide();\n                killProgress = IndicoUI.Dialogs.Util.progress();\n            },\n            error: handleAjaxError,\n            success: function(data) {\n                if (handleAjaxError(data)) {\n                    return;\n                }\n                else if (!data.success) {\n                    new AlertPopup($t.gettext('No logs available'), data.msg).open();\n                    return;\n                }\n                var doc = iframe[0].contentWindow.document;\n                doc.write(data.html);\n                doc.close();\n                logParams = data.params;\n                $('#chat-log-material').find('input, button').prop('disabled', false);\n                container.show();\n                materialWidget.show();\n            },\n            complete: function() {\n                killProgress();\n            }\n        });\n\n        $('#chat-create-material').on('click', function(e) {\n            e.preventDefault();\n            var $this = $(this);\n            var materialName = $('#chat-material-name').val().trim();\n            if (!materialName) {\n                return;\n            }\n            var params = $.extend({}, logParams, {\n                material_name: materialName\n            });\n            $.ajax({\n                url: $this.data('href'),\n                type: 'POST',\n                data: params,\n                dataType: 'json',\n                error: handleAjaxError,\n                complete: IndicoUI.Dialogs.Util.progress(),\n                success: function(data) {\n                    if (handleAjaxError(data)) {\n                        return;\n                    }\n                    else if (!data.success) {\n                        new AlertPopup($t.gettext('Could not create material'), data.msg).open();\n                        return;\n                    }\n                    $('#chat-log-material').find('input, button').prop('disabled', true).blur();\n                    new AlertPopup($t.gettext('Material created'), $t.gettext('The chat logs have been attached to the event.')).open();\n                }\n            });\n        });\n\n        var rangeWidget = $('#chat-log-range');\n        rangeWidget.daterange({\n            allowPast: true,\n            fieldNames: ['start_date', 'end_date'],\n            startDate: rangeWidget.data('startDate'),\n            endDate: rangeWidget.data('endDate'),\n            pickerOptions: {\n                yearRange: 'c-1:c+1'\n            }\n        });\n    };\n})(window);\n","// removed by extract-text-webpack-plugin"],"sourceRoot":""}