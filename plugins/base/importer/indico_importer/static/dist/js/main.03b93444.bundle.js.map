{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../plugins/base/importer/indico_importer/client/index.js","webpack:///../plugins/base/importer/indico_importer/client/main.css"],"names":["$t","$T","domain","ImporterUtils","resourcesExtensionList","reportNumberSystems","shortMonthsNames","gettext","minutesToTime","minutes","compareStartTime","a","b","startDate","time","sortedKeys","dict","sortFunc","array","each","item","push","sort","isPersonEmpty","person","firstName","familyName","_sendRequest","url","args","onSuccess","onError","$","ajax","async","method","data","success","textStatus","isFunction","error","xhr","title","message","format","statusText","toLowerCase","status","report_url","type","set","key","value","existed","i","keySequence","splice","getKeys","get","getValues","tmp","index","getLength","length","clear","shiftTop","idx","shiftBottom","_preload","hook","self","build_url","ImporterPlugin","urls","importers","dataType","handleAjaxError","_hideLists","importerList","hide","timetableList","emptySearchDiv","show","_showLists","refresh","drawContent","search","query","dom","importFrom","searchButton","Html","input","observeClick","select","importer","append","option","observeEvent","event","keyCode","PresearchContainer","height","_observeInsertButton","getSelectedList","getSelection","insertButton","disabledButtonWithTooltip","ImporterList","width","TableTreeList","topTimetable","div","className","style","pixels","draw","_getButtons","destination","entries","getLastImporter","ImporterDurationDialog","confId","timetable","redirect","clearSelection","showAfterSearch","reloadPage","close","buttons","eq","tooltip","disabled","ExclusivePopupWithButtons","prototype","call","_onClose","evt","location","reload","IndicoUI","Dialogs","Util","progress","window","parentTimetable","contextInfo","id","document","body","clientHeight","clientWidth","PreLoadHandler","open","execute","contentDiv","display","firstSearch","afterSearch","span","hereLink","afterSearchAction","entryType","info","substr","day_end_date","importer_name","block_end_date","entry_id","scheduleEntryId","sessionId","slotId","sessionSlotId","selectedDay","date","replace","durationField","contribDuration","timeField","redirectCheckbox","parameterManager","add","$B","accessor","IndicoUtil","createFormFromMap","_performRedirect","fragment","hash","_getUrl","eventId","day","params","add_contrib","session_block_id","contrib_id","contributionId","create_subcontrib_rest","_personLinkData","entry","authorType","linkDataEntry","author","speaker","undefined","isSpeaker","extend","linkData","primaryAuthor","primary","secondaryAuthor","secondary","none","eventInfo","isConference","speakersLinkData","_addContributionMaterial","link_url","subContributionId","requestUrl","add_link","attr","_addReference","create_subcontrib_reference_rest","create_contrib_reference_rest","check","parseFloat","split","duration","parseInt","hasError","killProgress","errorCallback","showErrorDialog","getAll","timeStr","summary","Json","write","successCallback","result","materials","reportNumbers","reportNumbersLabel","event_id","contribution_id","number","contribution","successFunction","WarningPopup","WatchObject","clearList","SelectableListWidget","recordDivs","selectedObserver","selectedList","getLastQuery","lastSearchQuery","lastSearchImporter","isMoreToImport","moreToImport","_searchBase","size","successFunc","callbacks","import_data","complete","records","_","callback","lastSearchSize","importedRecords","record","$O","lastLength","_getPersonString","affiliation","_drawSelectionIndex","selectionIndex","cssFloat","stopMouseEvent","cancelBubble","preventDefault","returnValue","which","button","innerHTML","observeSelection","_convertMaterials","materialsDict","mat","name","_getResourceName","resource","splittedName","_drawItem","recordDiv","reportNumber","em","summaryBeg","summaryEnd","showLink","hideLink","sumamaryDiv","materialType","link","href","target","list","lastChild","seq","top","events","listStyle","selectedStyle","customObserver","observer","QueueDict","importerWidget","handleContent","descriptionDiv","emptyDescriptionDiv","moreEntriesDiv","entriesCount","ngettext","_appendCallbacks","importerDiv","_drawImporterDiv","_drawHeader","setStyle","hidden","paddingBottom","textAlign","marginTop","overflow","ImporterListWidget","setSelection","selected","selectedDiv","fontWeight","boxShadow","MozBoxShadow","backgroundColor","level","color","textColor","titleDiv","endDate","displayBreaks","itemDiv","marginLeft","padding","entriesDiv","_drawShowHideButtons","showButton","img","src","imageSrc","hideButton","_insertFromTimetable","timetableData","getData","dayStyle","eventStyle","ListWidget","treeDiv","TimetableListWidget","on","ImportDialog"],"mappings":"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","file":"js/main.03b93444.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/plugins/importer/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","/* This file is part of Indico.\n * Copyright (C) 2002 - 2018 European Organization for Nuclear Research (CERN).\n *\n * Indico is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License as\n * published by the Free Software Foundation; either version 3 of the\n * License, or (at your option) any later version.\n *\n * Indico is distributed in the hope that it will be useful, but\n * WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Indico; if not, see <http://www.gnu.org/licenses/>.\n */\n\nimport './main.css';\n\n(function() {\n    var $t = $T.domain('importer');\n\n    /** Namespace for importer utility functions and variables */\n    var ImporterUtils = {\n         /** Possible extensions for resources */\n         resourcesExtensionList : {'pdf' : 1, 'doc' : 1, 'docx' : 1, 'ppt' : 1},\n\n         /** Maps importer name into report number system name */\n         reportNumberSystems: {\"invenio\" : \"cds\",\n                               \"dummy\" : \"Dummy\"},\n\n         /** Short names of the months. */\n         shortMonthsNames : [$t.gettext(\"Jan\"),\n                             $t.gettext(\"Feb\"),\n                             $t.gettext(\"Mar\"),\n                             $t.gettext(\"Apr\"),\n                             $t.gettext(\"May\"),\n                             $t.gettext(\"Jun\"),\n                             $t.gettext(\"Jul\"),\n                             $t.gettext(\"Aug\"),\n                             $t.gettext(\"Sep\"),\n                             $t.gettext(\"Oct\"),\n                             $t.gettext(\"Nov\"),\n                             $t.gettext(\"Dec\")],\n        /**\n         * Converts minutes to the hour string (format HH:MM).\n         * If minutes are greater than 1440 (24:00) value '00:00' is returned.\n         * @param minutes Integer containing number of minutes.\n         * @return hour string.\n         */\n         minutesToTime: function(minutes) {\n            if (minutes <= 1440) {\n                return ((minutes - minutes % 60)/ 60 < 10 ? \"0\" + (minutes  - minutes % 60) / 60:(minutes  - minutes % 60) / 60)\n                         + \":\" + (minutes % 60 < 10 ? \"0\" + minutes % 60:minutes % 60);\n            } else {\n                return '00:00';\n            }\n        },\n\n        /**\n         * Standard sorting function comparing start times of events.\n         * @param a first event.\n         * @param b second event.\n         * @return true if the first event starts later than the second. If not false.\n         */\n        compareStartTime: function (a, b) {\n            return a.startDate.time > b.startDate.time;\n        },\n\n        /**\n         * Returns array containing sorted keys of the dictionary.\n         * @param dict Dictionary to be sorted.\n         * @param sortFunc Function comparing keys of the dictionary.\n         * @return Array containg sorted keys.\n         */\n        sortedKeys: function(dict, sortFunc) {\n            var array = [];\n            each(dict, function(item) {\n                array.push(item);\n            });\n            return array.sort(sortFunc);\n        },\n\n        /**\n         * Checks if a dictionary contains empty person data.\n         */\n        isPersonEmpty: function(person) {\n            return !person || (!person.firstName && !person.familyName);\n        },\n\n        /**\n         * Send a POST request to indico.\n         * @param url The url where to post the data.\n         * @param data The data to POST.\n         * @param onSuccess Called when the request succeeds.\n         * @param onError Called when an error is encountered while performing the request.\n         */\n        _sendRequest: function(url, args, onSuccess, onError) {\n            $.ajax({\n                // There's no synchronisation on the server side yet thus make sure requests are sent serially\n                async: false,\n                url: url,\n                method: 'POST',\n                data: args,\n                success: function(data, textStatus) {\n                    if ($.isFunction(onSuccess)) {\n                        onSuccess(data, textStatus);\n                    }\n                },\n                error: function(xhr) {\n                    if ($.isFunction(onError)) {\n                        onError({\n                            title: $t.gettext('Something went wrong'),\n                            message: '{0} ({1})'.format(xhr.statusText.toLowerCase(), xhr.status),\n                            report_url: null\n                        });\n                    }\n                }\n            });\n        }\n    };\n\n\n    /**\n     * Imitates dictionary with keys ordered by the time element insertion.\n     */\n    type(\"QueueDict\", [], {\n\n            /**\n             * Inserts new element to the dictionary. If element's value is null removes an element.\n             * @param key element's key\n             * @param value element's value\n             */\n            set: function(key, value) {\n                var existed = false;\n                for (var i in this.keySequence) {\n                    if (key == this.keySequence[i]) {\n                        existed = true;\n                        if (value !== null) {\n                            this.keySequence[i] = value;\n                        } else {\n                            this.keySequence.splice(i, 1);\n                        }\n                    }\n                }\n                if (!existed) {\n                    this.keySequence.push(key);\n                }\n                this.dict[key] = value;\n            },\n\n            /**\n             * Gets list of keys. The list is sorted by an element insertion time.\n             */\n            getKeys: function() {\n                return this.keySequence;\n            },\n\n            /**\n             * Gets elements with the specified key.\n             */\n            get: function(key) {\n                return this.dict[key];\n            },\n\n            /**\n             * Gets list of values. The list is sorted by an element insertion time.\n             */\n            getValues: function() {\n                var tmp = [];\n                for (var index in this.keySequence) {\n                    tmp.push(this.get(this.keySequence[index]));\n                }\n                return tmp;\n            },\n\n            /**\n             * Returns number of elements in the dictionary.\n             */\n            getLength: function() {\n                return this.keySequence.length;\n            },\n\n            /**\n             * Removes all elements from the dictionary\n             */\n            clear: function() {\n                this.keySequence = [];\n                this.dict = {};\n            },\n\n            /**\n             * Moves the key one position towards the begining of the key list.\n             */\n            shiftTop: function(idx) {\n                if (idx > 0) {\n                    var tmp = this.keySequence[idx];\n                    this.keySequence[idx] = this.keySequence[idx - 1];\n                    this.keySequence[idx - 1] = tmp;\n                }\n            },\n\n            /**\n             * Moves the key one position towards the end of the key list.\n             */\n            shiftBottom: function(idx) {\n                if (idx < this.keySequence.length - 1) {\n                    var tmp = this.keySequence[idx];\n                    this.keySequence[idx] = this.keySequence[idx + 1];\n                    this.keySequence[idx + 1] = tmp;\n                }\n            }\n        },\n\n        function() {\n            this.keySequence = [];\n            this.dict = {};\n        }\n    );\n\n\n    type(\"ImportDialog\", [\"ExclusivePopupWithButtons\", \"PreLoadHandler\"], {\n            _preload: [\n                /** Loads a list of importers from the server */\n                function(hook) {\n                    var self = this;\n                    $.ajax({\n                        url: build_url(ImporterPlugin.urls.importers, {}),\n                        type: 'GET',\n                        dataType: 'json',\n                        success: function(data) {\n                            if (handleAjaxError(data)) {\n                                return;\n                            }\n                            self.importers = data;\n                            hook.set(true);\n                        }\n                    });\n                }\n            ],\n\n            /**\n             * Hides importer list and timetable list and shows information to type a new query.\n             */\n            _hideLists: function() {\n                this.importerList.hide();\n                this.timetableList.hide();\n                this.emptySearchDiv.show();\n            },\n\n            /**\n             * Shows importer list and timetable list and hides information to type a new query.\n             */\n            _showLists: function() {\n                this.importerList.show();\n                this.timetableList.refresh();\n                this.timetableList.show();\n                this.emptySearchDiv.hide();\n            },\n\n            /**\n             * Draws the content of the dialog.\n             */\n            drawContent : function() {\n                var self = this;\n                var search = function() {\n                    self.importerList.search(query.dom.value, importFrom.dom.value, 20, [function() {\n                        self._showLists();\n                    }]);\n                };\n                var searchButton = Html.input('button', {}, $t.gettext('search'));\n                searchButton.observeClick(search);\n                var importFrom = Html.select({});\n                for (var importer in this.importers)\n                    importFrom.append(Html.option({value:importer}, this.importers[importer]));\n                var query = Html.input('text', {});\n                query.observeEvent('keypress', function(event) {\n                    if (event.keyCode == 13) {\n                        search();\n                    }\n                });\n\n                this.emptySearchDiv = new PresearchContainer(this.height, function() {\n                    self._showLists();\n                });\n\n                /** Enables insert button whether some elements are selected at both importer and timetable list */\n                var _observeInsertButton =  function() {\n                    if (self.importerList.getSelectedList().getLength() > 0 && self.timetableList.getSelection()) {\n                        self.insertButton.disabledButtonWithTooltip('enable');\n                    } else {\n                        self.insertButton.disabledButtonWithTooltip('disable');\n                    }\n                };\n                this.importerList = new ImporterList([],\n                        {\"height\" : this.height - 80, \"width\" : this.width / 2 - 20, \"cssFloat\" : \"left\"},\n                        'entryList', 'entryListSelected', true, _observeInsertButton);\n                this.timetableList = new TableTreeList(this.topTimetable,\n                        {\"height\" : this.height - 80, \"width\" : this.width / 2 - 20, \"cssFloat\" : \"right\"},\n                        'treeList', 'treeListDayName', 'treeListEntry', true, _observeInsertButton);\n                return Html.div({},\n                        Html.div({className:'importDialogHeader', style:{width:pixels(this.width * 0.9)}}, query, searchButton, ' ', $t.gettext(\"in\"), ' ', importFrom),\n                        this.emptySearchDiv.draw(), this.importerList.draw(), this.timetableList.draw());\n            },\n\n            _getButtons: function() {\n                var self = this;\n                return [\n                    [$t.gettext('Proceed...'), function() {\n                        var destination = self.timetableList.getSelection();\n                        var entries = self.importerList.getSelectedList();\n                        var importer = self.importerList.getLastImporter();\n                        new ImporterDurationDialog(entries, destination,  self.confId, self.timetable, importer, function(redirect) {\n                            if (!redirect) {\n                                self._hideLists();\n                                self.timetableList.clearSelection();\n                                self.importerList.clearSelection();\n                                self.emptySearchDiv.showAfterSearch();\n                            }\n                            self.reloadPage = true;\n                        });\n                    }],\n                    [$t.gettext('Close'), function() {\n                        self.close();\n                    }]\n                ];\n            },\n\n            draw: function() {\n                this.insertButton = this.buttons.eq(0);\n                this.insertButton.disabledButtonWithTooltip({\n                    tooltip: $t.gettext('Please select contributions to be added and their destination.'),\n                    disabled: true\n                });\n                return this.ExclusivePopupWithButtons.prototype.draw.call(this, this.drawContent());\n            },\n\n            _onClose: function(evt) {\n                if (this.reloadPage) {\n                    location.reload();\n                    IndicoUI.Dialogs.Util.progress();\n                }\n                return self.ExclusivePopupWithButtons.prototype._onClose.call(this, evt);\n            }\n        },\n\n        /**\n         * Importer's main tab. Contains inputs for typing a query and select the importer type.\n         * After making a query imported entries are displayed at the left side of the dialog, while\n         * at the right side list of all entries in the event's timetable will be shown. User can add\n         * new contributions to the timetable's entry by simply selecting them and clicking at 'proceed'\n         * button.\n         * @param timetable Indico timetable object. If it's undefined constructor will try to fetch\n         * window.timetable object.\n         */\n        function(timetable) {\n            var self = this;\n            this.ExclusivePopupWithButtons($t.gettext(\"Import Entries\"));\n            this.timetable = timetable?timetable:window.timetable;\n            this.topTimetable = this.timetable.parentTimetable ? this.timetable.parentTimetable : this.timetable;\n            this.confId = this.topTimetable.contextInfo.id;\n            this.height = document.body.clientHeight - 200;\n            this.width = document.body.clientWidth - 200;\n            this.PreLoadHandler(\n                this._preload,\n                function() {\n                    self.open();\n                });\n            this.execute();\n        }\n    );\n\n\n    type(\"PresearchContainer\", [], {\n            /**\n             * Shows a widget.\n             */\n            show: function() {\n                this.contentDiv.dom.style.display = 'block';\n            },\n\n            /**\n             * Hides a widget.\n             */\n            hide: function() {\n                this.contentDiv.dom.style.display = 'none';\n            },\n\n            /**\n             * Changes a content of the widget. It should be used after making a first successful import.\n             */\n            showAfterSearch: function() {\n                this.firstSearch.dom.style.display = 'none';\n                this.afterSearch.dom.style.display = 'inline';\n            },\n\n            draw: function() {\n                this.firstSearch = Html.span({style:{display:\"inline\"}}, $t.gettext(\"Please type your search phrase and press 'search'.\"));\n                var hereLink = Html.span({className: 'fake-link'}, $t.gettext(\"here\"));\n                hereLink.observeClick(this.afterSearchAction);\n                this.afterSearch = Html.span(\n                    {style: {display: 'none'}},\n                    $t.gettext(\"Your entries were inserted successfully. Please specify a new query or click\"), ' ', hereLink, ' ', $t.gettext(\"to see the previous results.\")\n                );\n                this.contentDiv = Html.div({className:'presearchContainer', style:{\"height\" : pixels(this.height - 130)}}, this.firstSearch, this.afterSearch);\n                return this.contentDiv;\n            }\n        },\n\n        /**\n         * A placeholder for importer and timetable list widgets. Contains user's tips about what to do right now.\n         * @param widget's height\n         * @param function executed afer clicking 'here' link.\n         */\n        function(height, afterSearchAction) {\n            this.height = height;\n            this.afterSearchAction = afterSearchAction;\n        }\n    );\n\n\n    type(\"ImporterDurationDialog\", [\"ExclusivePopupWithButtons\", \"PreLoadHandler\"], {\n            _preload: [\n                /**\n                 * Fetches the default start time of the first inserted contribution.\n                 * Different requests are used for days, sessions and contributions.\n                 */\n                function(hook) {\n                    var self = this;\n                    //If the destination is a contribution, simply fetch the contribution's start time.\n                    if (this.destination.entryType == 'Contribution') {\n                        self.info.set(\"startTime\", this.destination.startDate.time.substr(0, 5));\n                        hook.set(true);\n                    } else {\n                        var url;\n                        if (this.destination.entryType == 'Day') {\n                            url = build_url(ImporterPlugin.urls.day_end_date, {\n                                importer_name: 'indico_importer',\n                                confId: this.confId\n                            });\n                        }\n                        if (this.destination.entryType == 'Session') {\n                            url = build_url(ImporterPlugin.urls.block_end_date, {\n                                importer_name: 'indico_importer',\n                                confId: this.confId,\n                                entry_id: this.destination.scheduleEntryId\n                            });\n                        }\n                        $.ajax({\n                            url: url,\n                            data: {\n                                sessionId: this.destination.sessionId,\n                                slotId: this.destination.sessionSlotId,\n                                selectedDay: this.destination.startDate.date.replace(/-/g, '/')\n                            },\n                            success: function(data) {\n                                self.info.set('startTime', data);\n                                hook.set(true);\n                            }\n                        });\n                    }\n                }\n            ],\n\n            drawContent: function() {\n                var durationField = Html.input('text', {}, this.destination.contribDuration?this.destination.contribDuration:20);\n                var timeField = Html.input('text', {});\n                var redirectCheckbox = Html.input('checkbox', {});\n\n                this.parameterManager.add(durationField, 'unsigned_int', false);\n                this.parameterManager.add(timeField, 'time', false);\n\n                $B(this.info.accessor(\"duration\"), durationField);\n                $B(timeField, this.info.accessor(\"startTime\"));\n                $B(this.info.accessor(\"redirect\"), redirectCheckbox);\n\n                return IndicoUtil.createFormFromMap([\n                    [$t.gettext(\"Duration time of every inserted contribution:\"), durationField],\n                    [$t.gettext(\"Start time of the first contribution:\"), timeField],\n                    [$t.gettext(\"Show me the destination:\"), redirectCheckbox]\n                ]);\n            },\n\n            /* Redirect to the timetable containing the created entry. */\n            _performRedirect: function() {\n                var fragment = this.destination.startDate.date.replace(/-/g, '');\n                if (this.destination.entryType == 'Session') {\n                    fragment += '.' + this.destination.id;\n                }\n                location.hash = fragment;\n                location.reload(); // Reload needed since only the fragment is changed\n            },\n\n            _getUrl: function(eventId, day, destination) {\n                var params = {\n                    'confId': eventId\n                };\n                if (destination.entryType == 'Day') {\n                    params.day = day;\n                    return build_url(ImporterPlugin.urls.add_contrib, params);\n                }\n                if (destination.entryType == 'Session') {\n                    params.day = day;\n                    params.session_block_id = destination.sessionSlotId;\n                    return build_url(ImporterPlugin.urls.add_contrib, params);\n                }\n                if (destination.entryType == 'Contribution') {\n                    params.contrib_id = destination.contributionId;\n                    return build_url(ImporterPlugin.urls.create_subcontrib_rest, params);\n                }\n            },\n\n            _personLinkData: function(entry) {\n                var authorType = {\n                    'none': 0,\n                    'primary': 1,\n                    'secondary': 2\n                };\n                var linkDataEntry = function(author, authorType, speaker) {\n                    if (speaker === undefined) {\n                        speaker = !!author.isSpeaker;\n                    }\n                    return $.extend({\n                        'authorType': authorType,\n                        'isSpeaker': speaker,\n                        'isSubmitter': false\n                    }, author);\n                };\n                var linkData = [];\n                if (!ImporterUtils.isPersonEmpty(entry.primaryAuthor)) {\n                    linkData.push(linkDataEntry(entry.primaryAuthor, authorType.primary));\n                }\n                if (!ImporterUtils.isPersonEmpty(entry.secondaryAuthor)) {\n                    linkData.push(linkDataEntry(entry.secondaryAuthor, authorType.secondary));\n                }\n                if (!ImporterUtils.isPersonEmpty(entry.speaker)) {\n                    linkData.push(linkDataEntry(entry.speaker, authorType.none, true));\n                }\n\n                if (!this.timetable.eventInfo.isConference) {\n                    // Only speakers are allowed in this type of event\n                    var speakersLinkData = [];\n                    $.each(linkData, function() {\n                        if (this.isSpeaker) {\n                            this.authorType = authorType.none;\n                            speakersLinkData.push(this);\n                        }\n                    });\n                    return speakersLinkData;\n                }\n                return linkData;\n            },\n\n            _addContributionMaterial: function(title, link_url, eventId, contributionId, subContributionId) {\n                var requestUrl;\n                if (subContributionId !== undefined) {\n                    requestUrl = build_url(ImporterPlugin.urls.add_link, {\n                        'confId': eventId,\n                        'contrib_id': contributionId,\n                        'subcontrib_id': subContributionId,\n                        'object_type': 'subcontribution'\n                    });\n                } else {\n                    requestUrl = build_url(ImporterPlugin.urls.add_link, {\n                        'confId': eventId,\n                        'contrib_id': contributionId,\n                        'object_type': 'contribution'\n                    });\n                }\n                var params = {\n                    'csrf_token': $('#csrf-token').attr('content'),\n                    'link_url': link_url,\n                    'title': title,\n                    'folder': '__None',\n                    'acl': '[]'\n                };\n                ImporterUtils._sendRequest(requestUrl, params);\n            },\n\n            _addReference: function(type, value, eventId, contributionId, subContributionId) {\n                var url;\n                if (subContributionId !== undefined) {\n                    url = build_url(ImporterPlugin.urls.create_subcontrib_reference_rest, {\n                        'confId': eventId,\n                        'contrib_id': contributionId,\n                        'subcontrib_id': subContributionId\n                    });\n                } else {\n                    url = build_url(ImporterPlugin.urls.create_contrib_reference_rest, {\n                        'confId': eventId,\n                        'contrib_id': contributionId\n                    });\n                }\n                var params = {\n                    'csrf_token': $('#csrf-token').attr('content'),\n                    'type': type,\n                    'value': value\n                };\n                ImporterUtils._sendRequest(url, params);\n            },\n\n            _getButtons: function() {\n                var self = this;\n                return [\n                    [$t.gettext('Insert'), function() {\n                        if (!self.parameterManager.check()) {\n                            return;\n                        }\n                        //Converts string containing contribution's start date(HH:MM) into a number of minutes.\n                        //Using parseFloat because parseInt('08') = 0.\n                        var time = parseFloat(self.info.get('startTime').split(':')[0]) * 60 + parseFloat(self.info.get('startTime').split(':')[1]);\n                        var duration = parseInt(self.info.get('duration'));\n                        //If last contribution finishes before 24:00\n                        if (time + duration * self.entries.getLength() <= 1440) {\n                            var hasError = false;\n                            var killProgress = IndicoUI.Dialogs.Util.progress();\n                            var errorCallback = function(error) {\n                                if (error) {\n                                    hasError = true;\n                                    showErrorDialog(error);\n                                }\n                            };\n                            var date = self.destination.startDate.date.replace(/-/g, '/');\n                            var args = [];\n                            each(self.entries.getValues(), function(entry) {\n                                entry = entry.getAll();\n                                var timeStr = ImporterUtils.minutesToTime(time);\n                                var params = {\n                                    'csrf_token': $('#csrf-token').attr('content'),\n                                    'title': entry.title ? entry.title : \"Untitled\",\n                                    'description': entry.summary,\n                                    'duration': [duration, 'minutes'],\n                                    'references': '[]'\n                                };\n                                if (self.destination.entryType == 'Contribution') {\n                                    $.extend(params, {\n                                        'speakers': Json.write(self._personLinkData(entry))\n                                    });\n                                } else {\n                                    $.extend(params, {\n                                        'time': timeStr,\n                                        'person_link_data': Json.write(self._personLinkData(entry)),\n                                        'location_data': '{\"address\": \"\", \"inheriting\": true}',\n                                        'type': '__None'\n                                    });\n                                }\n                                var url = self._getUrl(self.confId, date, self.destination);\n                                var successCallback = function(result) {\n                                    var materials = entry.materials || {};\n                                    var reportNumbers = entry.reportNumbers || [];\n                                    var reportNumbersLabel = ImporterUtils.reportNumberSystems[self.importer];\n                                    if (self.destination.entryType == 'Contribution') {\n                                        $.each(materials, function(title, url) {\n                                            self._addContributionMaterial(title, url, result.event_id,\n                                                                          result.contribution_id, result.id);\n                                        });\n                                        $.each(reportNumbers, function(idx, number) {\n                                            self._addReference(reportNumbersLabel, number, self.confId,\n                                                               result.contribution_id, result.id);\n                                        });\n                                    } else {\n                                        var contribution = result.entries[0].entry;\n                                        $.each(materials, function(title, url) {\n                                            self._addContributionMaterial(title, url, self.confId, contribution.contributionId);\n                                        });\n                                        $.each(reportNumbers, function(idx, number) {\n                                            self._addReference(reportNumbersLabel, number, self.confId, contribution.contributionId);\n                                        });\n                                    }\n                                };\n                                ImporterUtils._sendRequest(url, params, successCallback, errorCallback);\n                                time += duration;\n                            });\n                            if (self.successFunction) {\n                                self.successFunction(self.info.get('redirect'));\n                            }\n                            if (self.info.get('redirect')) {\n                                self._performRedirect();\n                            }\n                            self.close();\n                            killProgress();\n                        }\n                        else {\n                            new WarningPopup(\"Warning\", \"Some contributions will end after 24:00. Please modify start time and duration.\").open();\n                        }\n                    }],\n                    [$t.gettext('Cancel'), function() {\n                        self.close();\n                    }]\n                ];\n            },\n\n            draw: function() {\n                return this.ExclusivePopupWithButtons.prototype.draw.call(this, this.drawContent());\n            }\n        },\n\n        /**\n         * Dialog used to set the duration of the each contribution and the start time of the first on.\n         * @param entries List of imported entries\n         * @param destination Place into which entries will be inserted\n         * @param confId Id of the current conference\n         * @param timetable Indico timetable object of the current conference.\n         * @param importer Name of the used importer.\n         * @param successFunction Function executed after inserting events.\n         */\n        function(entries, destination, confId, timetable, importer, successFunction) {\n            var self = this;\n            this.ExclusivePopupWithButtons($t.gettext('Adjust entries'));\n            this.confId = confId;\n            this.entries = entries;\n            this.destination = destination;\n            this.timetable = timetable;\n            this.successFunction = successFunction;\n            this.importer = importer;\n            this.parameterManager = new IndicoUtil.parameterManager();\n            this.info = new WatchObject();\n            this.PreLoadHandler(\n                this._preload,\n                function() {\n                    self.open();\n                });\n            this.execute();\n        }\n    );\n\n    type(\"ImporterListWidget\", [\"SelectableListWidget\"], {\n            /**\n             * Removes all entries from the list\n             */\n            clearList: function() {\n                this.SelectableListWidget.prototype.clearList.call(this);\n                this.recordDivs = [];\n            },\n\n            /**\n             * Removes all selections.\n             */\n            clearSelection: function() {\n                this.SelectableListWidget.prototype.clearSelection.call(this);\n                this.selectedObserver(this.selectedList);\n            },\n\n            /**\n             * Returns number of entries in the list.\n             */\n            getLength: function() {\n                return this.recordDivs.length;\n            },\n\n            /**\n             * Returns the last query.\n             */\n            getLastQuery: function() {\n                return this.lastSearchQuery;\n            },\n\n            /**\n             * Returns the name of the last used importer.\n             */\n            getLastImporter: function() {\n                return this.lastSearchImporter;\n            },\n\n            /**\n             * Returns true if it's possible to import more entries, otherwise false.\n             */\n            isMoreToImport: function() {\n                return this.moreToImport;\n            },\n\n            /**\n             * Base search method. Sends a query to the importer.\n             * @param query A query string send to the importer\n             * @param importer A name of the used importer.\n             * @param size Number of fetched objects.\n             * @param successFunction Method executed after successful request.\n             * @param callbacks List of methods executed after request (doesn't matter if successful).\n             */\n            _searchBase: function(query, importer, size, successFunc, callbacks) {\n                var self = this;\n                $.ajax({\n                    // One more entry is fetched to be able to check if it's possible to fetch\n                    // more entries in case of further requests.\n                    url: build_url(ImporterPlugin.urls.import_data, {'importer_name': importer,\n                                                                     'query': query,\n                                                                     'size': size + 1}),\n                    type: 'POST',\n                    dataType: 'json',\n                    complete: IndicoUI.Dialogs.Util.progress(),\n                    success: function(data) {\n                        if (handleAjaxError(data)) {\n                            return;\n                        }\n                        successFunc(data.records);\n                        _.each(callbacks, function(callback) {\n                            callback();\n                        });\n                    }\n                });\n                //Saves last request data\n                this.lastSearchImporter = importer;\n                this.lastSearchQuery = query;\n                this.lastSearchSize = size;\n            },\n\n            /**\n             * Clears the list and inserts new imported entries.\n             * @param query A query string send to the importer\n             * @param importer A name of the used importer.\n             * @param size Number of fetched objects.\n             * @param callbacks List of methods executed after request (doesn't matter if successful).\n             */\n            search: function(query, importer, size, callbacks) {\n                var self = this;\n                var successFunc = function(result) {\n                    self.clearList();\n                    var importedRecords = 0;\n                    self.moreToImport = false;\n                    for (var record in result) {\n                        //checks if it's possible to import more entries\n                        if (size == importedRecords++) {\n                            self.moreToImport = true;\n                            break;\n                        }\n                        self.set(record, $O(result[record]));\n                    }\n                };\n                this._searchBase(query, importer, size, successFunc, callbacks);\n            },\n\n            /**\n             * Adds more entries to the current list. Uses previous query and importer.\n             * @param size Number of fetched objects.\n             * @param callbacks List of methods executed after request (doesn't matter if successful).\n             */\n            append: function(size, callbacks) {\n                var self = this;\n                var lastLength = this.getLength();\n                var successFunc = function(result) {\n                    var importedRecords = 0;\n                    self.moreToImport = false;\n                    for (var record in result) {\n                        // checks if it's possible to import more entries\n                        if (lastLength + size == importedRecords) {\n                            self.moreToImport = true;\n                            break;\n                        }\n                        // Some entries are already in the list so we don't want to insert them twice.\n                        // Entries with indexes greater or equal lastLength - 1 are not yet in the list.\n                        if (lastLength - 1 < importedRecords) {\n                            self.set(record, $O(result[record]));\n                        }\n                        ++importedRecords;\n                    }\n                };\n                this._searchBase(this.getLastQuery(), this.getLastImporter(), this.getLength() + size, successFunc, callbacks);\n            },\n\n            /**\n             * Extracts person's name, surname and affiliation\n             */\n            _getPersonString: function(person) {\n                return person.firstName + \" \" + person.familyName +\n                    (person.affiliation? \" (\" + person.affiliation + \")\" : \"\");\n            },\n\n            /**\n             * Draws sequence number attached to the item div\n             */\n            _drawSelectionIndex: function() {\n                var self = this;\n                var selectionIndex = Html.div({className:'entryListIndex', style:{display:'none', cssFloat:'left'}});\n                //Removes standard mouse events to enable custom right click event\n                var stopMouseEvent = function(event) {\n                    event.cancelBubble = true;\n                    if (event.preventDefault) {\n                        event.preventDefault();\n                    } else {\n                        event.returnValue = false;\n                    }\n                    return false;\n                };\n                selectionIndex.observeEvent('contextmenu', stopMouseEvent);\n                selectionIndex.observeEvent('mousedown', stopMouseEvent);\n                selectionIndex.observeEvent('click', stopMouseEvent);\n                selectionIndex.observeEvent('mouseup', function(event) {\n                    //Preventing event propagation\n                    event.cancelBubble = true;\n                    if (event.which === null) {\n                        /* IE case */\n                        var button = event.button == 1 ? \"left\" : \"notLeft\";\n                    } else {\n                        /* All others */\n                        var button = event.which == 1 ? \"left\" : \"notLeft\";\n                    }\n                    var idx = parseInt(selectionIndex.dom.innerHTML.substr(0, selectionIndex.dom.innerHTML.length - 2) - 1);\n                    if (button == \"left\") {\n                        self.selectedList.shiftTop(idx);\n                    } else {\n                        self.selectedList.shiftBottom(idx);\n                    }\n                    self.observeSelection(self.selectedList);\n                });\n                return selectionIndex;\n            },\n\n            /**\n             * Converts list of materials into a dictionary\n             */\n            _convertMaterials: function(materials) {\n                var materialsDict = {};\n                each(materials, function(mat) {\n                    var key = mat.name || '';\n                    if (!materialsDict[key]) {\n                        materialsDict[key] = [];\n                    }\n                    materialsDict[key].push(mat.url);\n                });\n                return materialsDict;\n            },\n\n            /**\n             * Converts resource link into a name.\n             */\n            _getResourceName: function(resource) {\n                var splittedName = resource.split('.');\n                if (splittedName[splittedName.length - 1] in ImporterUtils.resourcesExtensionList) {\n                    return splittedName[splittedName.length - 1];\n                } else {\n                    return 'resource';\n                }\n            },\n\n            /**\n             * Draws a div containing entry's data.\n             */\n            _drawItem : function(record) {\n                var self = this;\n                var recordDiv = Html.div({});\n                var key = record.key;\n                record = record.get();\n                // Empty fields are not displayed.\n                if (record.get(\"reportNumbers\")) {\n                    var reportNumber = Html.div({}, Html.em({}, $t.gettext(\"Report number(s)\")), \":\");\n                    each(record.get(\"reportNumbers\"), function(id) {\n                        reportNumber.append(\" \" + id);\n                    });\n                    recordDiv.append(reportNumber);\n                }\n                if (record.get(\"title\")) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Title\")), \": \", record.get(\"title\")));\n                }\n                if (record.get(\"meetingName\")) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Meeting\")), \": \", record.get(\"meetingName\")));\n                }\n                // Speaker, primary and secondary authors are stored in dictionaries. Their property have to be checked.\n                if (!ImporterUtils.isPersonEmpty(record.get('primaryAuthor'))) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Primary author\")), \": \", this._getPersonString(record.get(\"primaryAuthor\"))));\n                }\n                if (!ImporterUtils.isPersonEmpty(record.get('secondaryAuthor'))) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Secondary author\")), \": \", this._getPersonString(record.get(\"secondaryAuthor\"))));\n                }\n                if (!ImporterUtils.isPersonEmpty(record.get('speaker'))) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Speaker\")), \": \", this._getPersonString(record.get(\"speaker\"))));\n                }\n                if (record.get(\"summary\")) {\n                    var summary = record.get(\"summary\");\n                    //If summary is too long it need to be truncated.\n                    if (summary.length < 200) {\n                        recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Summary\")), \": \" , summary));\n                    } else {\n                        var summaryBeg = Html.span({}, summary.substr(0, 200));\n                        var summaryEnd = Html.span({style:{display:'none'}}, summary.substr(200));\n                        var showLink = Html.span({className:'fake-link'}, $t.gettext(\" (show all)\"));\n                        showLink.observeClick(function(evt) {\n                            summaryEnd.dom.style.display = \"inline\";\n                            showLink.dom.style.display = \"none\";\n                            hideLink.dom.style.display = \"inline\";\n                            //Preventing event propagation\n                            evt.cancelBubble=true;\n                            //Recalculating position of the selection number\n                            self.observeSelection(self.selectedList);\n                        });\n                        var hideLink = Html.span({className:'fake-link', style:{display:'none'}}, $t.gettext(\" (hide)\"));\n                        hideLink.observeClick(function(evt) {\n                            summaryEnd.dom.style.display = \"none\";\n                            showLink.dom.style.display = \"inline\";\n                            hideLink.dom.style.display = \"none\";\n                            //Preventing event propagation\n                            evt.cancelBubble=true;\n                            //Recalculating position of the selection number\n                            self.observeSelection(self.selectedList);\n                        });\n                        var sumamaryDiv = Html.div({}, Html.em({}, $t.gettext(\"Summary\")), \": \" , summaryBeg, showLink, summaryEnd, hideLink);\n                        recordDiv.append(sumamaryDiv);\n                    }\n                }\n                if (record.get(\"place\")) {\n                    recordDiv.append(Html.div({}, Html.em({}, $t.gettext(\"Place\")), \": \", record.get(\"place\")));\n                }\n                if (record.get(\"materials\")) {\n                    record.set(\"materials\", this._convertMaterials(record.get(\"materials\")));\n                    var materials = Html.div({}, Html.em({}, $t.gettext(\"Materials\")), \":\");\n                    for (var mat in record.get(\"materials\")) {\n                        var materialType = Html.div({}, mat ? (mat + \":\") : '');\n                        each(record.get(\"materials\")[mat], function(resource) {\n                            var link = Html.a({href:resource, target: \"_new\"}, self._getResourceName(resource));\n                            link.observeClick(function(evt) {\n                                //Preventing event propagation\n                                evt.cancelBubble = true;\n                            });\n                            materialType.append(\" \");\n                            materialType.append(link);\n                        });\n                        materials.append(materialType);\n                    }\n                    recordDiv.append(materials);\n                }\n                recordDiv.append(this._drawSelectionIndex());\n                this.recordDivs[key] = recordDiv;\n                return recordDiv;\n            },\n\n            /**\n             * Observer function executed when selection is made. Draws a number next to the item div, which\n             * represents insertion sequence of entries.\n             */\n            observeSelection: function(list) {\n                var self = this;\n                //Clears numbers next to the all divs\n                for (var entry in this.recordDivs) {\n                    var record = this.recordDivs[entry];\n                    record.dom.lastChild.style.display = 'none';\n                    record.dom.lastChild.innerHTML = '';\n                }\n                var seq = 1;\n                each(list.getKeys(), function(entry) {\n                    var record = self.recordDivs[entry];\n                    record.dom.lastChild.style.display = 'block';\n                    record.dom.lastChild.style.top = pixels(-(record.dom.clientHeight + 23) / 2);\n                    record.dom.lastChild.innerHTML = seq;\n                    switch(seq) {\n                        case 1:\n                            record.dom.lastChild.innerHTML += $t.gettext('st');\n                            break;\n                        case 2:\n                            record.dom.lastChild.innerHTML += $t.gettext('nd');\n                            break;\n                        case 3:\n                            record.dom.lastChild.innerHTML += $t.gettext('rd');\n                            break;\n                        default:\n                            record.dom.lastChild.innerHTML += $t.gettext('th');\n                            break;\n                    }\n                    ++seq;\n                });\n            }\n        },\n\n        /**\n         * Widget containing a list of imported contributions. Supports multiple selections of results and\n         * keeps selection order.\n         * @param events List of events to be inserted during initialization.\n         * @param listStyle Css class name of the list.\n         * @param selectedStyle Css class name of a selected element.\n         * @param customObserver Function executed while selection is made.\n         */\n        function(events, listStyle, selectedStyle, customObserver) {\n            var self = this;\n            // After selecting/deselecting an element two observers are executed.\n            // The first is a default one, used to keep selected elements order.\n            // The second one is a custom observer passed in the arguments list.\n            var observer = function(list) {\n                this.observeSelection(list);\n                if (customObserver) {\n                    customObserver(list);\n                }\n            };\n            this.SelectableListWidget(observer, false, listStyle, selectedStyle);\n            this.selectedList = new QueueDict();\n            this.recordDivs = {};\n            for (var record in events) {\n                this.set(record, $O(events[record]));\n            }\n        }\n    );\n\n\n    type(\"ImporterList\", [], {\n            /**\n             * Show the widget.\n             */\n            show: function() {\n                this.contentDiv.dom.style.display = 'block';\n            },\n\n            /**\n             * Hides the widget.\n             */\n            hide: function() {\n                this.contentDiv.dom.style.display = 'none';\n            },\n\n            /**\n             * Returns list of the selected entries.\n             */\n            getSelectedList: function() {\n                return this.importerWidget.getSelectedList();\n            },\n\n            /**\n             * Removes all entries from the selection list.\n             */\n            clearSelection: function() {\n                this.importerWidget.clearSelection();\n            },\n\n            /**\n             * Returns last used importer.\n             */\n            getLastImporter: function() {\n                return this.importerWidget.getLastImporter();\n            },\n\n            /**\n             * Changes widget's header depending on the number of results in the list.\n             */\n            handleContent: function() {\n                if (this.descriptionDiv && this.emptyDescriptionDiv) {\n                    if (this.importerWidget.getLength() === 0) {\n                        this.descriptionDiv.dom.style.display = 'none';\n                        this.emptyDescriptionDiv.dom.style.display = 'block';\n                        this.moreEntriesDiv.dom.style.display = 'none';\n                    } else {\n                        this.entriesCount.dom.innerHTML = $t.ngettext(\"One entry was found. \", \"{0} entries were found. \", this.importerWidget.getLength()).format(this.importerWidget.getLength());\n                        this.descriptionDiv.dom.style.display = 'block';\n                        this.emptyDescriptionDiv.dom.style.display = 'none';\n                        if (this.importerWidget.isMoreToImport()) {\n                            this.moreEntriesDiv.dom.style.display = 'block';\n                        } else {\n                            this.moreEntriesDiv.dom.style.display = 'none';\n                        }\n                    }\n                }\n            },\n\n            /**\n             * Adds handleContent method to the callback list. If callback list is empty, creates a new one\n             * containing only handleContent method.\n             * @return list with inserted handleContent method.\n             */\n            _appendCallbacks: function(callbacks) {\n                var self = this;\n                if (callbacks) {\n                    callbacks.push(function() {\n                        self.handleContent();\n                    });\n                } else {\n                    callbacks = [function() {\n                        self.handleContent();\n                    }];\n                }\n                return callbacks;\n            },\n\n            /**\n             * Calls search method from ImporterListWidget object.\n             */\n            search: function(query, importer, size, callbacks) {\n                this.importerWidget.search(query, importer, size, this._appendCallbacks(callbacks));\n            },\n\n            /**\n             * Calls append method from ImporterListWidget object.\n             */\n            append: function(size, callbacks) {\n                this.importerWidget.append(size, this._appendCallbacks(callbacks));\n            },\n\n            draw: function() {\n                var importerDiv = this._drawImporterDiv();\n                this.contentDiv = Html.div({className:'entryListContainer'}, this._drawHeader(), importerDiv);\n\n                for (var style in this.style) {\n                    this.contentDiv.setStyle(style, this.style[style]);\n                    if (style == 'height') {\n                        importerDiv.setStyle('height', this.style[style] - 76); //76 = height of the header\n                    }\n                }\n\n                if (this.hidden) {\n                    this.contentDiv.dom.style.display = 'none';\n                }\n\n                return this.contentDiv;\n            },\n\n            _drawHeader: function() {\n                this.entriesCount = Html.span({}, '0');\n                this.descriptionDiv = Html.div({className:'entryListDesctiption'}, this.entriesCount, $t.gettext(\"Please select the results you want to insert.\"));\n                this.emptyDescriptionDiv = Html.div({className:'entryListDesctiption'}, $t.gettext(\"No results were found. Please change the search phrase.\"));\n                return Html.div({}, Html.div({className:'entryListHeader'}, $t.gettext(\"Step 1: Search results:\")), this.descriptionDiv, this.emptyDescriptionDiv);\n            },\n\n            _drawImporterDiv: function() {\n                var self = this;\n                this.moreEntriesDiv = Html.div({className:'fake-link', style:{paddingBottom:pixels(15), textAlign:'center', clear: 'both', marginTop: pixels(15)}}, $t.gettext(\"more results\"));\n                this.moreEntriesDiv.observeClick(function() {\n                    self.append(20);\n                });\n                return Html.div({style:{overflow:'auto'}}, this.importerWidget.draw(), this.moreEntriesDiv);\n            }\n        },\n\n        /**\n         * Encapsulates ImporterListWidget. Adds a header depending on the number of entries in the least.\n         * Adds a button to fetch more entries from selected importer.\n         * @param events List of events to be inserted during initialization.\n         * @param style Dictionary of css styles applied to the div containing the list. IMPORTANT pass 'height'\n         * attribute as an integer not a string, because some further calculations will be made.\n         * @param listStyle Css class name of the list.\n         * @param selectedStyle Css class name of a selected element.\n         * @param hidden If true widget will not be displayed after being initialized.\n         * @param observer Function executed while selection is made.\n         */\n        function(events, style, listStyle, selectedStyle, hidden, observer) {\n            this.importerWidget = new ImporterListWidget(events, listStyle, selectedStyle, observer);\n            this.style = style;\n            this.hidden = hidden;\n        }\n    );\n\n\n    type(\"TimetableListWidget\", [\"ListWidget\"], {\n            /**\n             * Highlights selected entry and calls an observer method.\n             */\n            setSelection: function(selected, div) {\n                if (this.selectedDiv) {\n                    this.selectedDiv.dom.style.fontWeight = \"normal\";\n                    this.selectedDiv.dom.style.boxShadow = \"\";\n                    this.selectedDiv.dom.style.MozBoxShadow = \"\";\n                }\n                if (this.selected != selected) {\n                    this.selectedDiv = div;\n                    this.selected = selected;\n                    this.selectedDiv.dom.style.fontWeight = \"bold\";\n                    this.selectedDiv.dom.style.boxShadow = \"3px 3px 15px #000000\";\n                    this.selectedDiv.dom.style.MozBoxShadow = \"3px 3px 15px #000000\";\n                } else {\n                    this.selected = null;\n                    this.selectedDiv = null;\n                }\n                if (this.observeSelection) {\n                    this.observeSelection();\n                }\n            },\n\n            /**\n             * Deselects current entry.\n             */\n            clearSelection: function() {\n                if (this.selectedDiv) {\n                    this.selectedDiv.dom.style.backgroundColor = \"\";\n                }\n                this.selected = null;\n                this.selectedDiv = null;\n                if (this.observeSelection) {\n                    this.observeSelection();\n                }\n            },\n\n            /**\n             * Returns selected entry\n             */\n            getSelection: function() {\n                return this.selected;\n            },\n\n            /**\n             * Recursive function drawing timetable hierarchy.\n             * @param item Entry to be displayed\n             * @param level Recursion level. Used to set margins properly.\n             */\n            _drawItem : function(item, level) {\n                var self = this;\n                level = level?level:0;\n                // entry is a Day\n                switch(item.entryType) {\n                    case 'Contribution':\n                        item.color = \"#F8F2E8\";\n                        item.textColor = \"#000000\";\n                    case 'Session':\n                        var titleDiv = Html.div({className:\"treeListEntry\", style:{backgroundColor: item.color, color: item.textColor}},\n                                item.title + (item.startDate && item.endDate?\" (\" + item.startDate.time.substr(0, 5) + \" - \" + item.endDate.time.substr(0, 5) + \")\":\"\"));\n                        var entries = ImporterUtils.sortedKeys(item.entries, ImporterUtils.compareStartTime);\n                        break;\n                    case 'Break':\n                        if (this.displayBreaks) {\n                            var titleDiv = Html.div({className:\"treeListEntry\", style:{backgroundColor: item.color, color: item.textColor}},\n                                    item.title + (item.startDate && item.endDate?\" (\" + item.startDate.time.substr(0, 5) + \" - \" + item.endDate.time.substr(0, 5) + \")\":\"\"));\n                            var entries = ImporterUtils.sortedKeys(item.entries, ImporterUtils.compareStartTime);\n                        } else {\n                            return null;\n                        }\n                        break;\n                    case undefined:\n                        item.entryType = 'Day';\n                        item.startDate = {date : item.key.substr(0, 4) + \"-\" + item.key.substr(4, 2) + \"-\" + item.key.substr(6, 2)};\n                        item.color = \"#FFFFFF\";\n                        item.textColor = \"#000000\";\n                        var titleDiv = Html.div({className:\"treeListDayName\"},\n                                item.key.substr(6, 2) + \" \" + ImporterUtils.shortMonthsNames[parseFloat(item.key.substr(4, 2)) - 1] +\n                                \" \" + item.key.substr(0, 4));\n                        var entries = ImporterUtils.sortedKeys(item.get().getAll(), ImporterUtils.compareStartTime);\n                        break;\n                }\n                titleDiv.observeClick(function() {\n                    self.setSelection(item, titleDiv);\n                });\n                var itemDiv = Html.div({style:{marginLeft:pixels(level * 20), clear:\"both\", padding:pixels(5)}}, titleDiv);\n                var entriesDiv = Html.div({style:{display:\"none\"}});\n\n                //Draws subentries\n                for (var entry in entries) {\n                    entriesDiv.append(this._drawItem(entries[entry], level + 1));\n                }\n\n                //If there are any subentries, draws buttons to show/hide them on demand.\n                if (entries.length) {\n                    titleDiv.append(this._drawShowHideButtons(entriesDiv));\n                    itemDiv.append(entriesDiv);\n                }\n\n                return itemDiv;\n            },\n\n            /**\n             * Attaches buttons to the dom object which hide/show it when clicked.\n             */\n            _drawShowHideButtons: function(div) {\n                var showButton = Html.img({src: imageSrc(\"collapsd\"), style: {display: 'block'}});\n                var hideButton = Html.img({src: imageSrc(\"exploded\"), style: {display: 'none'}});\n                showButton.observeClick(function(evt) {\n                    div.dom.style.display = \"block\";\n                    showButton.dom.style.display = \"none\";\n                    hideButton.dom.style.display = \"block\";\n                    evt.cancelBubble = true;\n                });\n                hideButton.observeClick(function(evt) {\n                    div.dom.style.display = \"none\";\n                    showButton.dom.style.display = \"block\";\n                    hideButton.dom.style.display = \"none\";\n                    evt.cancelBubble = true;\n                });\n                return Html.div({className: 'expandButtonsDiv'}, showButton, hideButton);\n            },\n\n            /**\n             * Inserts entries from the timetable inside the widget.\n             */\n            _insertFromTimetable: function() {\n                var self = this;\n                var timetableData = this.timetable.getData();\n                each(this.timetable.sortedKeys, function(day) {\n                    self.set(day, $O(timetableData[day]));\n                });\n            },\n\n            /**\n             * Clears the list and inserts entries from the timetable inside the widget.\n             */\n            refresh: function() {\n                this.clear();\n                this._insertFromTimetable();\n            }\n        },\n\n        /**\n         * Draws event's timetable as a hierarchical expandable list.\n         * @param timetable Indico timetable object to be drawn\n         * @param listStyle Css class name of the list.\n         * @param dayStyle Css class name of day entries.\n         * @param eventStyle Css class name of session and contributions entries.\n         * @param observeSelection Funtcion executed after changing selection state.\n         * @param displayBreaks If true breaks will be displayed in the list. If false breaks are hidden.\n         */\n        function(timetable, listStyle, dayStyle, eventStyle, observeSelection, displayBreaks) {\n            this.timetable = timetable;\n            this.displayBreaks = displayBreaks;\n            this.observeSelection = observeSelection;\n            var self = this;\n            this.ListWidget(listStyle);\n            this._insertFromTimetable();\n        }\n    );\n\n\n    type(\"TableTreeList\", [], {\n\n            /**\n             * Show the widget.\n             */\n            show: function() {\n                this.contentDiv.dom.style.display = 'block';\n            },\n\n            /**\n             * Hides the widget\n             */\n            hide: function() {\n                this.contentDiv.dom.style.display = 'none';\n            },\n\n            /**\n             * Returns selected entry. TimetableListWidget method wrapper.\n             */\n            getSelection: function() {\n                return this.timetableList.getSelection();\n            },\n\n            /**\n             * Deselects current entry. TimetableListWidget method wrapper.\n             */\n            clearSelection: function() {\n                return this.timetableList.clearSelection();\n            },\n\n            /**\n             * Highlights selected entry and calls an observer method. TimetableListWidget method wrapper.\n             */\n            setSelection: function(selected, div) {\n                return this.timetableList.setSelection(selected, div);\n            },\n\n            /**\n             * Clears the list and inserts entries from the timetable inside the widget.\n             */\n            refresh: function() {\n                this.timetableList.refresh();\n            },\n\n            draw: function() {\n                this.contentDiv = Html.div({className:'treeListContainer'}, Html.div({className:'treeListHeader'}, $t.gettext(\"Step 2: Choose destination:\")),\n                        Html.div({className:'treeListDescription'}, $t.gettext(\"Please select the place in which the contributions will be inserted.\")));\n                var treeDiv = Html.div({style:{overflow:'auto'}}, this.timetableList.draw());\n                for (var style in this.style) {\n                    this.contentDiv.setStyle(style, this.style[style]);\n                    if (style == 'height') {\n                        treeDiv.setStyle('height', this.style[style] - 76);\n                    }\n                }\n                this.contentDiv.append(treeDiv);\n                if (this.hidden) {\n                    this.contentDiv.dom.style.display = 'none';\n                }\n                return this.contentDiv;\n            }\n        },\n\n        /**\n         * Draws event's timetable as a hierarchical expandable list.\n         * @param timetable Indico timetable object to be drawn\n         * @param style Dictionary of css styles applied to the div containing the list. IMPORTANT pass 'height'\n         * attribute as an integer not a string, because some further calculations will be made.\n         * @param listStyle Css class name of the list.\n         * @param dayStyle Css class name of day entries.\n         * @param eventStyle Css class name of session and contributions entries.\n         * @param observer Funtcion executed after changing selection state.\n         */\n        function(timetable, style, listStyle, dayStyle, eventStyle, hidden, observer) {\n            this.timetableList = new TimetableListWidget(timetable, listStyle, dayStyle, eventStyle, observer);\n            this.style = style;\n            this.hidden = hidden;\n        }\n    );\n\n\n    $(function() {\n        $('#timetable').on('click', '.js-create-importer-dialog', function() {\n            var timetable = $(this).data('timetable');\n            new ImportDialog(timetable);\n        });\n    });\n})();\n","// removed by extract-text-webpack-plugin"],"sourceRoot":""}